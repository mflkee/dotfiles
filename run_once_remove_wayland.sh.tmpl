#!/usr/bin/env bash
# Remove Wayland/Hyprland-related packages. Review before running.

set -euo pipefail

# Skip in restricted environments where sudo cannot escalate
if ! sudo -n true 2>/dev/null; then
  echo "skip: sudo not available (restricted environment)"
  exit 0
fi

pkgs=(
  hyprland hyprpaper hypridle hyprcursor hyprshot
  waybar tofi mako
  xdg-desktop-portal-hyprland xdg-desktop-portal-wlr
  wl-clipboard grim slurp wf-recorder wlr-randr kanshi wev wlsunset swww
  sway swaybg swayidle swaylock
)

if command -v pacman >/dev/null 2>&1; then
  echo "[Arch] Will remove (if installed): ${pkgs[*]}" >&2
  sudo pacman -Rns --noconfirm "${pkgs[@]}" || true
elif command -v apt >/dev/null 2>&1; then
  echo "[Debian/Ubuntu] Will remove (if installed): ${pkgs[*]}" >&2
  sudo apt purge -y "${pkgs[@]}" || true
  sudo apt autoremove -y || true
else
  echo "Unknown package manager. Remove these manually: ${pkgs[*]}" >&2
fi

exit 0
